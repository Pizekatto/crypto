!function(e){function t(t){for(var r,o,c=t[0],s=t[1],u=t[2],f=0,p=[];f<c.length;f++)o=c[f],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&p.push(a[o][0]),a[o]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r]);for(l&&l(t);p.length;)p.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,c=1;c<n.length;c++){var s=n[c];0!==a[s]&&(r=!1)}r&&(i.splice(t--,1),e=o(o.s=n[0]))}return e}var r={},a={0:0},i=[];function o(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=r,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var c=window.webpackJsonp=window.webpackJsonp||[],s=c.push.bind(c);c.push=t,c=c.slice();for(var u=0;u<c.length;u++)t(c[u]);var l=s;i.push([127,1]),n()}({127:function(e,t,n){n(128),e.exports=n(317)},314:function(e,t,n){},317:function(e,t,n){"use strict";n.r(t);n(314);var r=n(44),a=n(123),i=n(124);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e){return function(e){if(Array.isArray(e))return l(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_ROW":return[].concat(u(e),[t.payload]);default:return e}},p=Object(r.combineReducers)({table:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_ROW":return c(c({},e),{},{rows:f(e.rows,t)});case"ADD_TOTAL":return c(c({},e),{},{total:t.total});case"REWRITE_TABLE":return c(c({},e),{},{rows:t.payload});default:return e}},ui:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CHANGE_SECOND_CURRENCY":return c(c({},e),{},{secondcurrency:t.payload});case"SORTING":return c(c({},e),{},{sorting:t.payload});default:return e}},coins:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_COINS_DATA":return t.payload;default:return e}},exchanges:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_ALL_EXCHANGES":return c(c({},e),t.payload);default:return e}},cbrf:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return"ADD_CBRF_CURRENCIES"===t.type?c(c({},e),t.payload):e}});function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var h=function(){function e(){var t,n,r,a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),r=function(e){return e.map((function(e){var t=e.exchange,n=e.from,r=e.to;return a.createSub(t,n,r)}))},(n="createSubs")in(t=this)?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,this.apiBaseURL="wss://streamer.cryptocompare.com/v2",this.key="bfa3821152c6b9a655b29d87136b35ab2689aa121364a173900ab5bd6e8d3d9d",this.url=this.generateURL(this.apiBaseURL,{api_key:this.key}),this.socket=new WebSocket(this.url),this.socket.onclose=function(e){e.wasClean?(console.log("Соединение закрыто чисто, код",e.code),console.log("Причина",e.reason)):console.log("Соединение прервано, код",e.code)},this.socket.onopen=function(){console.log("Соединение установлено")},this.socket.onerror=function(e){return console.log(e.message)}}var t,n,r;return t=e,(n=[{key:"generateURL",value:function(e,t){var n=new URL(e);if(t)for(var r in t)n.searchParams.append(r,t[r]);return n}},{key:"capitalize",value:function(e){return(e=e.trim().toLowerCase())[0].toUpperCase()+e.slice(1)}},{key:"createSub",value:function(e,t,n){return"2~"+e+"~"+t+"~"+n}},{key:"subscribe",value:function(e){var t=this.createSubs(e);this.socket.send(JSON.stringify({format:"streamer",action:"SubAdd",subs:t}))}},{key:"unsubscribe",value:function(e){var t=this.createSubs(e);this.socket.send(JSON.stringify({action:"SubRemove",subs:t}))}}])&&d(t.prototype,n),r&&d(t,r),e}();function v(e,t,n,r,a,i,o){try{var c=e[i](o),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,a)}function b(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){v(i,r,a,o,c,"next",e)}function c(e){v(i,r,a,o,c,"throw",e)}o(void 0)}))}}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var g=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),m(this,"startData",b(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("./startData.json");case 2:return t=e.sent,e.abrupt("return",t.json());case 4:case"end":return e.stop()}}),e)})))),m(this,"getData",function(){var e=b(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(t);case 3:return n=e.sent,e.abrupt("return",n.json());case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()),m(this,"getCBRF",b(regeneratorRuntime.mark((function e(){var n,r,a,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=JSON.parse(localStorage.getItem("cbrf")))){e.next=9;break}if(r=Date.now()-n.lastupdated.timestamp,864e5,!(r<864e5)){e.next=9;break}return a=Math.trunc(r/1e3/60/60),i=Math.round(r/1e3/60%60),console.log("C момента обновления курса ЦБ прошло","".concat(a,"ч ").concat(i,"м")),e.abrupt("return",n);case 9:return e.next=11,t.cbrf();case 11:return o=e.sent,localStorage.setItem("cbrf",JSON.stringify(o)),e.abrupt("return",o);case 14:case"end":return e.stop()}}),e)})))),m(this,"cbrf",b(regeneratorRuntime.mark((function e(){var t,n,r,a,i,o,c,s,u,l,f,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://www.cbr-xml-daily.ru/daily_json.js",e.next=3,fetch("https://www.cbr-xml-daily.ru/daily_json.js",{cache:"no-store"});case 3:return t=e.sent,e.next=6,t.json();case 6:for(p in n=e.sent,r=n.Timestamp,r=Date.parse(r),a=new Date(r).toLocaleString(),i=n.Valute,o=i.BYN,c=i.EUR,s=i.USD,u=i.UAH,f={lastupdated:{timestamp:r,datetime:a}},l={BYN:o,EUR:c,USD:s,UAH:u})f[p.toLowerCase()]={},f[p.toLowerCase()].code=l[p].CharCode,f[p.toLowerCase()].value=l[p].Value;return e.abrupt("return",f);case 15:case"end":return e.stop()}}),e)})))),this.key="bfa3821152c6b9a655b29d87136b35ab2689aa121364a173900ab5bd6e8d3d9d",this.apiBaseURL="https://min-api.cryptocompare.com",this.infoBaseURL="https://cryptocompare.com"}var t,n,r,a,i,o,c,s;return t=e,(n=[{key:"generateURL",value:function(e,t){return new URL(t,e)}},{key:"checkData",value:function(e){var t=e.TYPE,n=e.FROMSYMBOL,r=e.MARKET,a=e.PRICE;return 2==t&&n&&r&&a}},{key:"prepareWsData",value:function(e){var t=e.FROMSYMBOL,n=e.MARKET,r=e.PRICE,a=e.LASTUPDATE;return{coin:t,exchange:n,price:r,lastupdated:a,to:e.TOSYMBOL,id:t+a}}},{key:"getBTCCourse",value:(s=b(regeneratorRuntime.mark((function e(){var t,n,r,a,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r in t=this.generateURL(this.apiBaseURL,"/data/price"),n={api_key:this.key,fsym:"BTC",tsyms:"USD,USDT,RUB"})t.searchParams.append(r,n[r]);return e.next=6,this.getData(t);case 6:for(o in a=e.sent,i={btc:{to:{}}},a)i.btc.to[o.toLowerCase()]=a[o];return e.abrupt("return",i);case 10:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"getAllCoins",value:(c=b(regeneratorRuntime.mark((function e(){var t,n,r,a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={api_key:this.key},e.next=4,this.extractData("/data/blockchain/list",t);case 4:for(a in n=e.sent,r=[],n)i=n[a].symbol,r.push(i);return e.abrupt("return",r);case 8:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"getAllExchanges",value:(o=b(regeneratorRuntime.mark((function e(){var t,n,r,a,i,o,c,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={api_key:this.key},e.next=4,this.extractData("/data/exchanges/general",t);case 4:for(a in n=e.sent,r={},n)i=n[a],o=i.AffiliateURL,c=i.Name,s=i.LogoUrl,r[c.toLowerCase()]={name:c,url:o,logo:s};return e.abrupt("return",r);case 8:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"getExchangesWithPairs",value:(i=b(regeneratorRuntime.mark((function e(){var t,n,r,a,i,o,c,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="/data/v4/all/exchanges",e.next=3,this.startData();case 3:return n=e.sent,r=n.exchanges,a={api_key:this.key},e.next=8,this.extractData(t,a);case 8:for(s in i=e.sent,o=i.exchanges,c={list:[]},o)r.includes(s.toLowerCase())&&function(){c.list.push(s),c[s.toLowerCase()]={},c[s.toLowerCase()].name=s;var e=o[s].pairs,t=Object.entries(e),n=new Intl.Collator("en");t.sort((function(e,t){return n.compare(e[0],t[0])})),c[s.toLowerCase()].pairs=Object.fromEntries(t);var r=c[s.toLowerCase()].pairs;for(var a in r)r[a].tsyms=Object.keys(r[a].tsyms)}();return e.abrupt("return",c);case 13:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"extractData",value:(a=b(regeneratorRuntime.mark((function e(t,n){var r,a,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.generateURL(this.apiBaseURL,t),n)for(a in n)r.searchParams.append(a,n[a]);return e.next=4,this.getData(r);case 4:return i=e.sent,o=i.Data,e.abrupt("return",o);case 7:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})}])&&y(t.prototype,n),r&&y(t,r),e}();function w(e,t,n,r,a,i,o){try{var c=e[i](o),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,a)}function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach((function(t){O(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function D(e){return function(e){if(Array.isArray(e))return E(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return E(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return E(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function E(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var k=new h,j=new g,R=function(e){return{type:"CHANGE_SECOND_CURRENCY",payload:e}},L=function(e){return{type:"SORTING",payload:e}},C=function(e){return{type:"ADD_ROW",payload:e}},A=function(e){return{type:"ADD_COINS_DATA",payload:e}},P=function(e){return{type:"ADD_ALL_EXCHANGES",payload:e}},T=function(e){return{type:"REWRITE_TABLE",payload:e}},U=function(e){return!!e.table.rows.find((function(e){return e.edited}))},I=function(e,t){return e.coin===t.coin&&e.exchange===t.exchange},_=function(e,t){var n=e.table.rows,r=n.findIndex((function(e){return e.id===t.id})),a=n.slice(0,r),i=n.slice(r+1);return[].concat(D(a),[t],D(i))},B=function(e,t){return e.table.rows.filter((function(e){return e.id!=t}))},N=function(e,t){return e.map((function(e){var n=e.coin,r=e.exchange,a=function(e,t,n){var r=n.exchanges[t.toLowerCase()].pairs[e].tsyms;return r.includes("USD")?"USD":r.includes("USDT")?"USDT":r.includes("BTC")?"BTC":null}(n,r,t);return{exchange:r,from:n,to:a}}))},M=function(e){return function(t,n){var r=n();if((e=function(e,t){var n=e.exchanges,r=t.coin,a=t.exchange;return x(x({},t),{},{coin:r.toUpperCase(),exchange:n[a].name})}(r,e)).exist){var a=r.table.rows.find((function(t){return I(t,e)}));if(a){a=x(x({},a),{},{amount:e.amount,edited:!1});var i=_(r,a);t(T(i))}else{var o=N([e],n()),c=N([e.cache],n());k.unsubscribe(c),delete e.cache,e.subscribed=!1,e.edited=!1;var s=_(r,e);t(T(s)),t(F(o))}}else{var u=r.table.rows.find((function(t){return I(t,e)&&t.id!==e.id}));if(u)new Promise((function(e,t){confirm("Такая запись уже существует. ОК - Прибавить к существующему значению. ОТМЕНА - перезаписать новым значением")?e():t()})).then((function(){u=x(x({},u),{},{amount:u.amount+e.amount,edited:!1})})).catch((function(){u=x(x({},u),{},{amount:e.amount,edited:!1})})).finally((function(){var n=_(r,u);n=n.filter((function(t){return t.id!==e.id})),t(T(n))}));else{var l=N([e],n()),f=B(r,e.id);e.subscribed=!1,e.edited=!1,t(T(f)),t(C(e)),t(F(l))}}}},F=function(e){return function(){k.subscribe(e)}},W=function(){return function(e,t){return k.socket.onmessage=function(n){U(t())||e(q(n.data))},new Promise((function(e){setTimeout((function t(){1!==k.socket.readyState?setTimeout(t,50):e(k.socket.readyState)}),50)}))}},q=function(e){return function(t,n){var r=JSON.parse(e);if(j.checkData(r)){var a=n().coins.btc,i=function(e,t){var n=e.price,r=e.to;if(n)return"BTC"===r&&(n*=t.to.usd),delete e.to,x(x({},e),{},{price:n})}(j.prepareWsData(r),a);t(J(x(x({},i),{},{subscribed:!0})))}}},J=function(e){return function(t,n){var r=n().table.rows,a=e.price,i=n().ui.secondcurrency,o=n().cbrf,c=+function(e,t,n){var r=n.byn,a=n.eur,i=n.usd,o=n.uah;switch(t){case"rub":return e*i.value;case"uah":return e*o.value;case"eur":return e*i.value/a.value;case"byn":return e*i.value/r.value}}(a,i,o).toFixed(3),s=r.map((function(t){if(I(t,e)){var n=+(t.amount*a).toFixed(3);return x(x(x({},t),e),{},{completed:!0,exist:!0,pricesecond:c,value:n})}return t}));t(T(s))}},H=function(e){return function(t,n){var r=n().table.rows.map((function(t){if(t.id===e){var n=t.edited?null:{coin:t.coin,exchange:t.exchange};return x(x({},t),{},{edited:!t.edited,cache:n})}return t}));t(T(r))}},Y=function(e){return function(t,n){var r=n(),a=function(e,t){return e.table.rows.find((function(e){return e.id==t}))}(r,e);if(a.subscribed){var i=N([a],r);k.unsubscribe(i)}var o=B(r,e);t(T(o))}};function G(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function V(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var $=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;G(this,e);var r=t.coin,a=void 0===r?"":r,i=t.exchange,o=void 0===i?"":i,c=t.amount,s=void 0===c?0:c,u=t.price,l=void 0===u?0:u,f=t.id,p=void 0===f?"":f,d=t.pricesecond,h=t.value,v=t.completed;this.state=n,this.btc=n.coins.btc,this.cbrf=n.cbrf,this.coin=a,this.exchange=o,this.amount=s,this.price=l||"",this.priceSecond=d||"",this.value=h||"",this.id=p,this.completed=v}var t,n,r;return t=e,(n=[{key:"field",get:function(){var e=this.price.toLocaleString("en",{style:"currency",currency:"USD",minimumFractionDigits:3}),t=this.priceSecond.toLocaleString("ru",{style:"currency",currency:"RUB",minimumFractionDigits:0,maximumFractionDigits:0}),n=this.value.toLocaleString("en",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}),r='\n      <li class="exchange col">'.concat(this.exchange,'</li>\n      <li class="currency col">').concat(this.coin,'</li>\n      <li class="value col">').concat(this.amount,'</li>\n      <li class="price col">').concat(e,'</li>\n      <li class="price-second col">').concat(this.completed?t:"загрузка...",'</li>\n      <li class="amount col">\n        <span class="amount-value">').concat(n,'</span>\n      </li>\n      <li class="edit-buttons">\n        <div>\n          <button class="amount-btn icon icon-edit success" id="edit"></button>\n          <button class="amount-btn icon icon-delete cancel" id="delete"></button>\n        </div>\n      </li>\n    '),a=document.createElement("UL");return a.className="table-row table-row_body",a.id=this.id,a.innerHTML=r,a}}])&&V(t.prototype,n),r&&V(t,r),e}();function K(e){return function(e){if(Array.isArray(e))return X(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return X(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return X(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function X(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function z(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Q=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var r=t.coin,a=void 0===r?"":r,i=t.exchange,o=void 0===i?"":i,c=t.amount,s=void 0===c?0:c,u=t.price,l=void 0===u?0:u,f=t.id,p=void 0===f?"":f,d=t.exist;this.state=n,this.cbrg=n.cbrf,this.coin=a,this.exchange=o||n.exchanges.list[0],this.amount=s,this.price=l?l.toFixed(3):"",this.priceSecond=l?Math.round(this.price*this.cbrg.usd.value):"",this.value=l?(this.price*s).toFixed(2):"",this.id=p,this.exist=d,this.allExchanges=n.exchanges,this.exchangesSelect=this.createSelect(n.exchanges.list,this.exchange,"exchange","exchanges-list");var h=this.getStartCoinsList();this.coinsSelect=this.createSelect(h,this.coin,"coin","coins-list"),this.inputNubmer=this.createInputNumber(),this.form=this.createForm(),this.priceUSDElem=this.form.querySelector("#price-usd"),this.priceSecondElem=this.form.querySelector("#price-second"),this.valueUSDElem=this.form.querySelector("#value-usd")}var t,n,r;return t=e,(n=[{key:"getStartCoinsList",value:function(){var e=this.state.exchanges[this.exchange.toLowerCase()].pairs;return Object.keys(e)}},{key:"createSelect",value:function(e,t,n,r){var a=document.createElement("SELECT");if(a.id=n,a.name=n,a.className=r,e.forEach((function(e){var t=new Option(e,e.toLowerCase());a.append(t)})),t){var i=K(a.options).findIndex((function(e){return e.value===t.toLowerCase()}));a[i].defaultSelected=!0}return a}},{key:"createInputNumber",value:function(){var e=this,t=document.createElement("INPUT");return t.type="number",0==this.price?t.step=1:this.price>0&&this.price<10?t.step=5:this.price>10&&this.price<1e3?t.step=.01:t.step=1e-4,t.min=0,t.value=this.amount||1,t.name="amount",t.classList.add("input-amount"),t.onchange=function(t){if(e.price){var n=t.target.value;e.valueUSDElem.textContent=(n*e.price).toFixed(2)}},t}},{key:"correctExchangesNames",value:function(e,t){return e.map((function(e){var n=t[e.toLowerCase()].name;if(n)return n}))}},{key:"actions",value:function(){var e=this;return new Promise((function(t,n){var r=function(n){n.preventDefault();var r=e.form.elements,a=r.coin.value,i=r.exchange.value,o=+r.amount.value,c=e.price?+e.price:0,s=Date.now(),u=e.id;t({data:{coin:a,exchange:i,amount:o,price:c,id:u,lastupdated:s},id:u})},a=function(t){t.preventDefault(),n(e.id)};e.applyBtn.addEventListener("click",r),e.declineBtn.addEventListener("click",a),e.removeListeners=function(){console.log("Remove Listeners"),removeEventListener("click",r),removeEventListener("click",a)}}))}},{key:"createForm",value:function(){var e=this,t='\n      <ul class="table-row table-row_body" id="'.concat(this.id,'">\n        <li class="exchange col" id="exchanges"></li>\n        <li class="currency col" id="coins"></li>\n        <li class="value col" id="amount-coin"></li>\n        <li class="price col" id="price-usd">').concat(this.price,'</li>\n        <li class="price-second col" id="price-second">').concat(this.priceSecond,'</li>\n        <li class="amount col">\n          <span class="value-usd" id="value-usd">').concat(this.value,'</span>\n        </li>\n        <li class="edit-buttons">\n          <div>\n            <button class="amount-btn icon icon-ok success" id="apply"></button>\n            <button class="amount-btn icon icon-cancel cancel" id="decline"></button>\n          </div>\n        </li>\n      </ul>\n    '),n=document.createElement("FORM");n.name="create",n.className="table-form",n.innerHTML=t,n.querySelector(".table-row").classList.add("edited"),n.querySelector("#exchanges").append(this.exchangesSelect),this.exist&&(this.exchangesSelect.disabled=!0);var r=n.querySelector("#coins");return r.append(this.coinsSelect),this.exist||(this.coinsSelect.disabled=!0),n.querySelector("#amount-coin").append(this.inputNubmer),this.exist||(this.inputNubmer.disabled=!0),n.oninput=function(t){switch(t.target){case e.exchangesSelect:e.coinsSelect.disabled=!1;var n=t.target.value;e.insertNewCoinsList(n,r);break;case e.coinsSelect:e.exchangesSelect.disabled=!0,e.inputNubmer.disabled=!1}},this.applyBtn=n.querySelector("#apply"),this.declineBtn=n.querySelector("#decline"),n}},{key:"insertNewCoinsList",value:function(e,t){var n=[],r=this.allExchanges[e].pairs;for(var a in r)n.push(a);for(var i=this.createSelect(n,this.coin,"coin","coins-list");t.firstChild;)t.firstChild.remove();t.append(i),this.coinsSelect=i}}])&&z(t.prototype,n),r&&z(t,r),e}(),Z=n(126);n.n(Z).a.polyfill();function ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(n),!0).forEach((function(t){ne(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ne(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var re,ae,ie=document.getElementById("table"),oe=document.getElementById("table-body"),ce=document.getElementById("table-header"),se=document.getElementById("total"),ue=document.getElementById("all"),le=Object(r.createStore)(p,Object(i.composeWithDevTools)(Object(r.applyMiddleware)(a.a,(function(e){return function(t){return function(n){if("REWRITE_TABLE"===n.type){var r=t(n),a=e.getState(),i=a.table.rows,o={ui:a.ui};return o.rows=i.map((function(e){return{coin:e.coin,exchange:e.exchange,amount:e.amount}})),localStorage.setItem("state",JSON.stringify(o)),r}return t(n)}}}),(function(e){return function(t){return function(n){var r=e.getState().ui.sorting;if("REWRITE_TABLE"===n.type&&r.type)switch(r.type){case"coin":case"exchange":var a=new Intl.Collator("en");n.payload.sort((function(e,t){return a.compare(e[r.type],t[r.type])})),r.reverse&&n.payload.reverse();break;case"amount":case"price":case"pricesecond":case"value":n.payload.sort((function(e,t){return r.reverse?t[r.type]-e[r.type]:e[r.type]-t[r.type]}))}return t(n)}}}),(function(){return function(e){return function(t){return"REWRITE_TABLE"===t.type&&(t.payload=t.payload.map((function(e){return e.value=+(e.amount*e.price).toFixed(3),e}))),e(t)}}}),(function(e){return function(t){return function(n){if("REWRITE_TABLE"===n.type){var r=n.payload.reduce((function(e,t){return t.completed?e+Math.round(t.value):e}),0);e.dispatch({type:"ADD_TOTAL",total:r})}return t(n)}}}))));ie.onclick=function(e){if(e.target.closest("BUTTON")){var t=e.target.closest("BUTTON"),n=e.target.closest(".table-row");switch(t.id){case"edit":le.dispatch(H(n.id));break;case"delete":le.dispatch(Y(n.id));break;case"add":le.dispatch((function(e,t){var n={edited:!0,completed:!1,id:Date.now(),exist:!1};U(t())||e(C(n))}))}}},ce.onclick=function(e){if(e.target.closest("li")){var t=e.target.closest("li"),n=le.getState().ui.sorting,r=n.type,a=n.reverse;le.dispatch(L({type:t.id,reverse:t.id===r&&!a}));var i=le.getState().table.rows;le.dispatch(T(i)),ce.querySelectorAll("li").forEach((function(e){e.classList.remove("sorted","reverse")})),t.classList.add("sorted"),(a=le.getState().ui.sorting.reverse)&&t.classList.add("reverse")}},le.subscribe((function(){!function(e){for(;oe.firstChild;)oe.firstChild.remove();var t=e.table.rows;if(t){t.forEach((function(t){if(t.edited){var n=new Q(t,e);oe.append(n.form),n.actions().then((function(e){var n=e.data;le.dispatch(M(te(te({},t),n)))})).catch((function(e){le.getState().table.rows.find((function(t){return t.id==e})).exist?le.dispatch(H(e)):le.dispatch(Y(e))})).finally((function(){n.removeListeners()}))}else{var r=new $(t,e);oe.append(r.field)}}));var n=le.getState().table.total;n&&(n=n.toLocaleString("en",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}),ue.textContent="Всего",se.textContent=n)}}(le.getState())})),le.dispatch(function(){var e,t=(e=regeneratorRuntime.mark((function e(t,n){var r,a,i,o,c,s,u,l,f,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.getCBRF();case 2:return r=e.sent,t({type:"ADD_CBRF_CURRENCIES",payload:r}),e.next=6,j.startData();case 6:return a=e.sent,i=a.exchanges,o=a.ui,c=o.secondcurrency,s=o.sorting,t(R(c)),u=JSON.parse(localStorage.getItem("state"))||a,(l=u.rows).forEach((function(e){e.edited=!1,e.completed=!1,t(C(e))})),e.next=13,j.getExchangesWithPairs(i);case 13:return f=e.sent,t(P(f)),e.next=17,t(W());case 17:return k.subscribe(N(l,n())),t(L(s)),e.next=21,j.getBTCCourse();case 21:p=e.sent,t(A(p));case 23:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){w(i,r,a,o,c,"next",e)}function c(e){w(i,r,a,o,c,"throw",e)}o(void 0)}))});return function(e,n){return t.apply(this,arguments)}}()),re=document.querySelectorAll(".fx"),ae=new IntersectionObserver((function(e){e.forEach((function(e){if(e.isIntersecting){var t=e.target,n=e.target.getAttribute("data-delay"),r=e.target.getAttribute("data-duration"),a=e.target.getAttribute("data-fx");t.style.visibility="visible",n&&(t.style.animationDelay=n),r&&(t.style.animationDuration=r),a&&t.classList.add(a),ae.unobserve(e.target)}}))}),{rootMargin:"0% 0% -5% 0%"}),re.forEach((function(e){return ae.observe(e)})),window.addEventListener("click",(function(e){var t=e.target.closest("A");if(t&&t.href.includes("#")){e.preventDefault();var n=new URL(t.href).hash;document.querySelector(n).scrollIntoView({behavior:"smooth"})}}))}});